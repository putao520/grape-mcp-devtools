# Windowsç®¡ç†å‘˜æƒé™æ£€æµ‹åŠŸèƒ½

## æ¦‚è¿°

Grape MCP DevTools ç°åœ¨å…·å¤‡æ™ºèƒ½çš„Windowsç®¡ç†å‘˜æƒé™æ£€æµ‹åŠŸèƒ½ã€‚å½“ç¨‹åºåœ¨Windowsç³»ç»Ÿä¸Šè¿è¡Œæ—¶ï¼Œä¼šè‡ªåŠ¨æ£€æµ‹å½“å‰æ˜¯å¦ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œï¼Œå¹¶æ ¹æ®æƒé™çŠ¶æ€è°ƒæ•´å·¥å…·å®‰è£…è¡Œä¸ºã€‚

## æ ¸å¿ƒåŠŸèƒ½

### 1. è‡ªåŠ¨æƒé™æ£€æµ‹

ç¨‹åºå¯åŠ¨æ—¶ä¼šè‡ªåŠ¨æ£€æµ‹ï¼š
- âœ… **ç®¡ç†å‘˜æ¨¡å¼**: å¯ä»¥æ‰§è¡Œè‡ªåŠ¨å®‰è£…
- âš ï¸ **æ™®é€šç”¨æˆ·æ¨¡å¼**: æ˜¾ç¤ºæ‰‹åŠ¨å®‰è£…å‘½ä»¤

### 2. æ™ºèƒ½å®‰è£…ç­–ç•¥

#### ç®¡ç†å‘˜æ¨¡å¼ä¸‹
- è‡ªåŠ¨æ‰§è¡Œå·¥å…·å®‰è£…å‘½ä»¤
- æ”¯æŒç³»ç»ŸåŒ…ç®¡ç†å™¨ï¼ˆchoco, winget, scoopï¼‰
- å¯ä»¥å®‰è£…éœ€è¦ç®¡ç†å‘˜æƒé™çš„å·¥å…·

#### æ™®é€šç”¨æˆ·æ¨¡å¼ä¸‹
- ä¸æ‰§è¡Œä»»ä½•å®‰è£…å‘½ä»¤
- æ˜¾ç¤ºè¯¦ç»†çš„æ‰‹åŠ¨å®‰è£…æŒ‡å—
- åŒºåˆ†éœ€è¦ç®¡ç†å‘˜æƒé™çš„å·¥å…·

### 3. è¯¦ç»†çš„å®‰è£…æŒ‡å—

å½“æ£€æµ‹åˆ°éç®¡ç†å‘˜æ¨¡å¼æ—¶ï¼Œç¨‹åºä¼šæ˜¾ç¤ºï¼š

```
ğŸ“‹ è¯·æ‰‹åŠ¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…ç¼ºå¤±çš„å·¥å…·:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ—£ï¸ cpp è¯­è¨€å·¥å…·:
   ğŸ”§ doxygen
      ğŸ“ æè¿°: C++æ–‡æ¡£ç”Ÿæˆæ ‡å‡†
      ğŸ›¡ï¸ éœ€è¦ç®¡ç†å‘˜æƒé™:
      ğŸ“‹ å‘½ä»¤: choco install doxygen.install
      ğŸ’¡ è¯·ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ PowerShell æˆ– CMD
      ğŸ”„ å‡çº§å‘½ä»¤: choco upgrade doxygen.install
      âœ… éªŒè¯å‘½ä»¤: doxygen --version

ğŸ—£ï¸ python è¯­è¨€å·¥å…·:
   ğŸ”§ mkdocs
      ğŸ“ æè¿°: æ–‡æ¡£ç”Ÿæˆå·¥å…·
      ğŸ“‹ å‘½ä»¤: pip install mkdocs
      ğŸ”„ å‡çº§å‘½ä»¤: pip install --upgrade mkdocs
      âœ… éªŒè¯å‘½ä»¤: mkdocs --version
```

## æŠ€æœ¯å®ç°

### Windows APIé›†æˆ

ä½¿ç”¨Windows APIè¿›è¡Œæƒé™æ£€æµ‹ï¼š

```rust
#[cfg(target_os = "windows")]
fn is_elevated() -> bool {
    use winapi::um::handleapi::CloseHandle;
    use winapi::um::processthreadsapi::{GetCurrentProcess, OpenProcessToken};
    use winapi::um::securitybaseapi::GetTokenInformation;
    use winapi::um::winnt::{TokenElevation, TOKEN_ELEVATION, TOKEN_QUERY};
    
    // æ£€æŸ¥å½“å‰è¿›ç¨‹çš„æå‡ä»¤ç‰Œ
    // è¿”å› true è¡¨ç¤ºç®¡ç†å‘˜æƒé™ï¼Œfalse è¡¨ç¤ºæ™®é€šç”¨æˆ·æƒé™
}
```

### è·¨å¹³å°å…¼å®¹

- **Windows**: ä½¿ç”¨WinAPIæ£€æµ‹ç®¡ç†å‘˜æƒé™
- **Linux/macOS**: æ£€æŸ¥æ˜¯å¦ä¸ºrootç”¨æˆ·ï¼ˆuid = 0ï¼‰

### å®‰è£…ç­–ç•¥åˆ†ç±»

å·¥å…·æŒ‰æƒé™éœ€æ±‚åˆ†ç±»ï¼š

1. **éœ€è¦ç®¡ç†å‘˜æƒé™**:
   - `choco install` å‘½ä»¤
   - `winget install` å‘½ä»¤
   - ç³»ç»Ÿçº§å®‰è£…

2. **æ™®é€šç”¨æˆ·æƒé™**:
   - `cargo install` å‘½ä»¤
   - `pip install --user` å‘½ä»¤
   - `npm install -g` å‘½ä»¤ï¼ˆå¦‚æœnpmé…ç½®å…è®¸ï¼‰

## ä½¿ç”¨ç¤ºä¾‹

### æµ‹è¯•æƒé™æ£€æµ‹

è¿è¡Œæµ‹è¯•ç¨‹åºï¼š

```bash
cargo run --bin test_windows_admin
```

### åœ¨ä¸»ç¨‹åºä¸­ä½¿ç”¨

```rust
let config = ToolInstallConfig {
    strategy: InstallStrategy::Interactive,
    auto_upgrade: true,
    install_timeout_secs: 300,
    prefer_global: true,
    backup_existing: false,
};

let installer = ToolInstaller::new(config);
let missing_tools = installer.detect_missing_tools(&detected_languages).await?;
let install_report = installer.auto_install_tools(&missing_tools).await?;
```

## å®‰å…¨è€ƒè™‘

### æƒé™æœ€å°åŒ–åŸåˆ™
- åªåœ¨å¿…è¦æ—¶è¦æ±‚ç®¡ç†å‘˜æƒé™
- ä¼˜å…ˆä½¿ç”¨ç”¨æˆ·çº§å®‰è£…æ–¹å¼
- æ˜ç¡®æ ‡è¯†éœ€è¦ç®¡ç†å‘˜æƒé™çš„æ“ä½œ

### é€æ˜åº¦
- æ¸…æ¥šæ˜¾ç¤ºå°†è¦æ‰§è¡Œçš„å‘½ä»¤
- è§£é‡Šä¸ºä»€ä¹ˆéœ€è¦ç®¡ç†å‘˜æƒé™
- æä¾›æ‰‹åŠ¨å®‰è£…çš„æ›¿ä»£æ–¹æ¡ˆ

## é…ç½®é€‰é¡¹

### InstallStrategy æšä¸¾

```rust
pub enum InstallStrategy {
    /// è‡ªåŠ¨å®‰è£…ï¼ˆé™é»˜ï¼‰
    Auto,
    /// è¯¢é—®ç”¨æˆ·ç¡®è®¤
    Interactive,
    /// åªæ£€æµ‹ä¸å®‰è£…
    DetectOnly,
    /// å¼ºåˆ¶é‡æ–°å®‰è£…
    Force,
}
```

### ToolInstallConfig ç»“æ„

```rust
pub struct ToolInstallConfig {
    pub strategy: InstallStrategy,
    pub auto_upgrade: bool,
    pub install_timeout_secs: u64,
    pub prefer_global: bool,
    pub backup_existing: bool,
}
```

## é”™è¯¯å¤„ç†

### æƒé™ä¸è¶³
- æ£€æµ‹åˆ°æƒé™ä¸è¶³æ—¶ï¼Œä¼˜é›…é™çº§åˆ°æ‰‹åŠ¨æ¨¡å¼
- æä¾›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯å’Œè§£å†³æ–¹æ¡ˆ

### å®‰è£…å¤±è´¥
- è®°å½•è¯¦ç»†çš„å¤±è´¥åŸå› 
- æä¾›æ•…éšœæ’é™¤å»ºè®®
- æ”¯æŒé‡è¯•æœºåˆ¶

## æ—¥å¿—è¾“å‡º

ç¨‹åºä¼šè¾“å‡ºè¯¦ç»†çš„æ—¥å¿—ä¿¡æ¯ï¼š

```
âš ï¸ æ£€æµ‹åˆ°éç®¡ç†å‘˜æ¨¡å¼è¿è¡Œï¼Œéƒ¨åˆ†å·¥å…·å®‰è£…éœ€è¦ç®¡ç†å‘˜æƒé™
ğŸ’¡ æç¤º: ä½¿ç”¨ 'ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ' å¯åŠ¨ç¨‹åºå¯å¯ç”¨è‡ªåŠ¨å®‰è£…åŠŸèƒ½
ğŸ”§ å¼€å§‹è‡ªåŠ¨å®‰è£…ç¼ºå¤±çš„å·¥å…·...
âš ï¸ éç®¡ç†å‘˜æ¨¡å¼è¿è¡Œï¼Œå°†æ˜¾ç¤ºæ‰‹åŠ¨å®‰è£…å‘½ä»¤
```

## æœªæ¥æ”¹è¿›

### è®¡åˆ’åŠŸèƒ½
1. **UACæç¤ºé›†æˆ**: è‡ªåŠ¨è¯·æ±‚ç®¡ç†å‘˜æƒé™æå‡
2. **åŒ…ç®¡ç†å™¨æ£€æµ‹**: æ™ºèƒ½æ£€æµ‹å¯ç”¨çš„åŒ…ç®¡ç†å™¨
3. **å®‰è£…è¿›åº¦æ˜¾ç¤º**: å®æ—¶æ˜¾ç¤ºå®‰è£…è¿›åº¦
4. **å›æ»šåŠŸèƒ½**: æ”¯æŒå®‰è£…å¤±è´¥æ—¶çš„å›æ»š

### æ€§èƒ½ä¼˜åŒ–
1. **å¹¶è¡Œå®‰è£…**: æ”¯æŒå¤šä¸ªå·¥å…·å¹¶è¡Œå®‰è£…
2. **ç¼“å­˜æœºåˆ¶**: ç¼“å­˜æƒé™æ£€æµ‹ç»“æœ
3. **é¢„æ£€æŸ¥**: å®‰è£…å‰éªŒè¯æ‰€æœ‰ä¾èµ–

## æ€»ç»“

Windowsç®¡ç†å‘˜æƒé™æ£€æµ‹åŠŸèƒ½ä¸ºGrape MCP DevToolsæä¾›äº†ï¼š

- âœ… **æ™ºèƒ½æƒé™æ£€æµ‹**: è‡ªåŠ¨è¯†åˆ«è¿è¡Œæƒé™
- âœ… **å®‰å…¨çš„å®‰è£…ç­–ç•¥**: æ ¹æ®æƒé™è°ƒæ•´è¡Œä¸º
- âœ… **ç”¨æˆ·å‹å¥½çš„æç¤º**: æ¸…æ™°çš„æ‰‹åŠ¨å®‰è£…æŒ‡å—
- âœ… **è·¨å¹³å°å…¼å®¹**: æ”¯æŒWindows/Linux/macOS
- âœ… **è¯¦ç»†çš„æ—¥å¿—è®°å½•**: ä¾¿äºé—®é¢˜è¯Šæ–­

è¿™ç¡®ä¿äº†å·¥å…·åœ¨å„ç§æƒé™ç¯å¢ƒä¸‹éƒ½èƒ½æ­£å¸¸å·¥ä½œï¼ŒåŒæ—¶ä¿æŒäº†å®‰å…¨æ€§å’Œç”¨æˆ·ä½“éªŒã€‚ 